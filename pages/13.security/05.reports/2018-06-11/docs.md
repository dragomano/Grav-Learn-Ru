---
title: "Grav Admin: Moderately Critical, Access Bypass, ADMIN-2018-001"
published: true
date: 11-07-2018
---

- ID: ADMIN-2018-001
- Project: Grav Admin plugin
- Date: 11-07-2018
- Risk-level: Moderately Critical

Задачи администратора a имеют низкий уровень специфичности доступа, DirectInstall особенно должен быть разрешен только супер-администраторами.

### Рекомендация

Обновление плагина админки до версии v1.8.6. Уязвимость в большей степени относится к сайтам с несколькими или многими пользователями, в меньшей — к нескольким или отдельным пользователям.

### Описание

Некоторые задачи в интерфейсе плагина администратора были доступны зарегистрированным пользователям нижнего уровня. Это позволяет пользователям без полномочий `admin.login` обновлять ленту новостей, проверять наличие обновлений через GPM, обрабатывать уведомления и переустанавливать пакеты. Пользователи без разрешений `admin.pages` могут обрабатывать Markdown, удалять медиафайлы или менять язык. Пользователи без разрешений `admin.super`, которые могут делать все это, также могут выполнять прямую установку с помощью загруженных пакетов.

Пользователи, способные выполнять запросы POST низкого уровня с аутентифицированным доступом к интерфейсу плагина администратора, могут выполнять любую из этих задач. Хотя большинство из них не критично, особенно прямая установка допускает удаленное выполнение кода.

### Затронутые версии

Затронуты версии админ-плагина до 1.8.6, обнаруженные в 1.8.5.

### Решение

Исправлено в [Admin/Classes/AdminController](https://github.com/getgrav/grav-plugin-admin/blob/e87217a2426864669cc63740620f5bd702860874/classes/admincontroller.php), строки 879-882, 931-934, 981-984, 1024-1027, 1236-1244, 1873-1875, 2202-2205, 2231-2280 [11 июля 2018](https://github.com/getgrav/grav-plugin-admin/commit/e87217a2426864669cc63740620f5bd702860874).


### Атрибуция

Сообщил [cure53-alex](https://github.com/cure53-alex), исправил [Andy Miller](https://github.com/rhukster).